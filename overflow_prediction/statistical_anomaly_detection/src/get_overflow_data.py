TOP_99_AS = ["15169","16509","20940","202818","32934","6185","46489","2906","22822","32590","15133","0","20446","65013","3356","16625","5483","16276","60781","60068","8068","54113","24940","8972","49981","65505","9009","56467","65050","714","13335","39572","8302","29789","12876","174","8881","35402","8075","35415","203043","44178","51324","199156","6830","8560","43350","47764","12989","48345","6855","58073","61157","8403","24961","19679","14061","28753","199524","6724","3209","25291","12912","15555","41690","57976","49453","201011","29066","14618","31042","60558","203220","34086","62041","31334","9121","3223","12312","31615","196922","54994","60626","20773","65205","1299","3303","16097","41095","36351","12576","50389","6939","8708","44066","23393","47541","20948","36408"]
NEW_TOP_10_AS = ["16509", "20940", "32934", "16276", "46489", "22822", "15169", "15133", "2906", "202818"]

AUTONOMOUS_SYSTEMS = {'15169': '{"filters":{"AS_SRC_INGRESS":["15169"],"AS_HND_INGRESS":["!15169"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"start":1498867200,"end":1577318399,"pos":"AS_HND_INGRESS","whitelist":{"AS_SRC_INGRESS":["15169"],"AS_HND_INGRESS":["6453","3257","174","1299","6762","5391","8928","3356","1273","65013"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"linkFilter":null,"aggregations":{}}',
                      '20940': '{"filters":{"AS_SRC_INGRESS":["20940"],"AS_HND_INGRESS":["!20940"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"start":1498867200,"end":1577318399,"pos":"AS_HND_INGRESS","whitelist":{"AS_SRC_INGRESS":["20940"],"AS_HND_INGRESS":["6762","3257","2914","6461","1299","6453","1273","3356","9002","209"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"linkFilter":null,"aggregations":{}}',
                      '2906': '{"filters":{"AS_SRC_INGRESS":["2906"],"AS_HND_INGRESS":["!2906"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"start":1498867200,"end":1577318399,"pos":"AS_HND_INGRESS","whitelist":{"AS_SRC_INGRESS":["2906"],"AS_HND_INGRESS":["3356","6762","12337","9121","5391","44178","9067","44530","35704","1273"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"linkFilter":null,"aggregations":{}}',
                      '16509': '{"filters":{"AS_SRC_INGRESS":["16509"],"AS_HND_INGRESS":["!16509"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"start":1498867200,"end":1577318399,"pos":"AS_HND_INGRESS","whitelist":{"AS_SRC_INGRESS":["16509"],"AS_HND_INGRESS":["1299","2914","6453","3257","174","209","3356","3491","4637","6939"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"linkFilter":null,"aggregations":{}}',
                      '32934': '{"filters":{"AS_SRC_INGRESS":["32934"],"AS_HND_INGRESS":["!32934"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"start":1498867200,"end":1577318399,"pos":"AS_HND_INGRESS","whitelist":{"AS_SRC_INGRESS":["32934"],"AS_HND_INGRESS":["1299","2914","3356","174","6762","3257","3491","6453","20949","6939"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"linkFilter":null,"aggregations":{}}',
                      '6185': '{"filters":{"AS_SRC_INGRESS":["6185"],"AS_HND_INGRESS":["!714"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"start":1498867200,"end":1577318399,"pos":"AS_HND_INGRESS","whitelist":{"AS_SRC_INGRESS":["6185"],"AS_HND_INGRESS":["3356","1299","1273","6453","3257","2828","2914","3491","8220","4637"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"linkFilter":null,"aggregations":{}}',
                      '15133': '{"filters":{"AS_SRC_INGRESS":["15133"],"AS_HND_INGRESS":["!15133"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"start":1498867200,"end":1577318399,"pos":"AS_HND_INGRESS","whitelist":{"AS_SRC_INGRESS":["15133"],"AS_HND_INGRESS":["1299","2914","701","174","4766","4637","5511","6939","37100","12713"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"linkFilter":null,"aggregations":{}}',
                      '22822': '{"filters":{"AS_SRC_INGRESS":["22822"],"AS_HND_INGRESS":["!22822"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"start":1498867200,"end":1577318399,"pos":"AS_HND_INGRESS","whitelist":{"AS_SRC_INGRESS":["22822"],"AS_HND_INGRESS":["174","6453","6762","3257","5511","3491","3356","4637","2914","44178"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"linkFilter":null,"aggregations":{}}',
                      '46489': '{"filters":{"AS_SRC_INGRESS":["46489"],"AS_HND_INGRESS":["!46489"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"start":1498867200,"end":1577318399,"pos":"AS_HND_INGRESS","whitelist":{"AS_SRC_INGRESS":["46489"],"AS_HND_INGRESS":["1299","6939","174","2914","3356","701","6453","209","4637","6762"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"linkFilter":null,"aggregations":{}}',
                      '32590': '{"filters":{"AS_SRC_INGRESS":["32590"],"AS_HND_INGRESS":["!32590"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"start":1498867200,"end":1577318399,"pos":"AS_HND_INGRESS","whitelist":{"AS_SRC_INGRESS":["32590"],"AS_HND_INGRESS":["3356","1299","5511","12989","2914","6762","1273","174","6939","7922"],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"linkFilter":null,"aggregations":{}}'}
START_DATE = '2017-7-1'
END_DATE = '2020-1-31'
from get_data import get_timeseries_with_data_str


def get_data_autonomous_systems():
    for key, val in AUTONOMOUS_SYSTEMS.items():
        df = get_timeseries_with_data_str(val)
        df.to_csv(f'{key}_1.7.2017-25.12.2019.csv')


def get_data_top_10():
    for ass in NEW_TOP_10_AS:
        ass_str = '{"filters":{"AS_SRC_INGRESS":["%s"],"AS_HND_INGRESS":[],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"start":1498867200,"end":1577836799,"pos":"AS_HND_INGRESS","whitelist":{"AS_SRC_INGRESS":["%s"],"AS_HND_INGRESS":[],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"linkFilter":null,"aggregations":{}}' % (ass, ass)
        df = get_timeseries_with_data_str(ass_str)
        df.to_csv(f'{ass}_1.7.2017-31.12.2019.csv')

def get_data_top_10_incl_corona():
    for ass in NEW_TOP_10_AS:
        ass_str = '{"filters":{"AS_SRC_INGRESS":["%s"],"AS_HND_INGRESS":[],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"start":1498867200,"end":1588917599,"pos":"AS_HND_INGRESS","whitelist":{"AS_SRC_INGRESS":["%s"],"AS_HND_INGRESS":[],"ROUTER_IN_INGRESS":[],"INTERFACE_IN_INGRESS":[],"ROUTER_OUT_INGRESS":[],"AS_NXT_INGRESS":[],"AS_DST_INGRESS":[],"AS_SRC_EGRESS":[],"ROUTER_OUT_EGRESS":[],"AS_NXT_EGRESS":[],"AS_DST_EGRESS":[]},"linkFilter":null,"aggregations":{}}' % (ass, ass)
        df = get_timeseries_with_data_str(ass_str)
        df.to_csv(f'{ass}_1.7.2017-8.5.2020.csv')


get_data_top_10_incl_corona()